# Goコードの記述と最適化

このドキュメントでは、高性能なGoコードを記述するためのベストプラクティスについて説明します。

現時点では、ビデオ、スライド、ブログ記事（「awesome-golang-performance」など）へのリンク集ですが、コンテンツが外部でなくここにある、より長い本形式に進化させるつもりです。リンクはカテゴリ別にソートする必要があります。

個々のサービスの高速化（キャッシングなど）についていくつか議論を行いますが、高パフォーマンスな分散システムの設計は範囲外です。まったく異なる一連の研究と設計のトレードオフを網羅しています。

すべてのコンテンツはCC-BY-SAの下でライセンスされます。

この本はつぎのセクションに分かれています。
   1) 遅くないソフトウェアを書くための基本的なヒント
     * CS 101-level のコンテンツ
   2) 高速なソフトウェアを書くためのヒント
     * Goの性能の引き出し方に関するGo固有のセクション
   3) *本当*に高速なソフトウェアを書くための高度なヒント
     * 最適化されたコードに高速化の余地がある場合

これらの3つのセクションを以下のように要約できます。
- 愚かになるな
- 賢くなれ
- 危険をおかせ

### いつ、どこを最適化するか

本当に最も重要なステップなので最初に書きます。あなたは最適化を行うべきなのでしょうか？

すべての最適化にはコストがかかります。一般的に、このコストはコードの複雑さか認知負荷の観点で表現されます。つまり、最適化されたコードは最適化されていないバージョンよりもシンプルであることは滅多にありません。

しかし、最適化の経済という別の側面があります。プログラマーとして、あなたの時間は貴重です。バグ修正や機能追加など、プロジェクトにおいて取り組む機会機会費用があります。最適化するのは楽しいですが、選択するのがしつも適切な仕事ではありません。パフォーマンスは機能ですが、リリースや品質もしかりです。

作業する最重要なものを選択するのです。それは時にはCPU最適化ではなく、ユーザーエクスペリエンスです。プログレスバーを追加するシンプルなものだったり、ページのレンダリング後にバックグラウンドで処理してページのレスポンスを改善することだったりします。

3時間後の毎時レポートが1時間もかからないレポートより役に立たないこともあるのです。

簡単に最適化できるからといっても最適化する価値があるわけではありません。容易に解決できる問題を無視することは有効な開発戦略です。

これを*あなたの*時間最適化だと考えてください。

何を最適化すべきかを選択し、いつ最適化すべきかを選択するのです。

「時期尚早な最適化」を定義してください。97%がそうですが、重要な3%に取り組んでください。

TPOP: 最適化すべきだろうか？「すべきだ。しかし、プログラムが本当に遅すぎ、問題が重要であるときに限る上に、正確さ、堅牢性、明快さを維持しつつ高速化されるという期待がある」

高速なソフトウェアか高速な開発です。

http://bitfunnel.org/strangeloop に数値があります。1台につき年1000USドルする機器が3万台必要な架空の検索エンジンを想像してください。ソフトウェアのスピードを倍増させることで年間1500万ドルを節約できます。1%削減するために開発者が1年取り組んでも割りに合うでしょう。

たいていの場合、プログラムのサイズとスピードは重要ではありません。至極単純な最適化は行う必要がありません。2番目に簡単な最適化は、より速いハードウェアを購入することです。

プログラムを変更しようと決めたら、続きを読んでください。

